# üìä Benchmark

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å [`query_benchmark.py`](./query_benchmark.py).  
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ—Ä–∏—Ç—å:

1. **–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å** (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞, –±–∞–ª–∞–Ω—Å —Å–∫–æ–±–æ–∫, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤ –±–µ–∑ –∫–∞–≤—ã—á–µ–∫).  
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (–Ω–µ—Ç –æ–ø–∞—Å–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π: `UNION SELECT`, `DROP`, `EXEC`, `GRANT`, –∏ –¥—Ä.).  
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** (7 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª):
   - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `SELECT *`;  
   - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `IN` –≤–º–µ—Å—Ç–æ —Ü–µ–ø–æ—á–µ–∫ `OR`;  
   - –∑–∞–ø—Ä–µ—Ç `NOT IN`;  
   - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —É—Å–ª–æ–≤–∏–π;  
   - `HAVING` —Ç–æ–ª—å–∫–æ —Å –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏;  
   - –∑–∞–ø—Ä–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö join-–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é;  
   - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏—à–Ω–∏—Ö –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ `FROM`.  

## –ú–µ—Ç—Ä–∏–∫–∏

- `validity_score` ‚Äî —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–∞–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏.  
- `optimization_score` ‚Äî —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º.  
- `security_score` ‚Äî —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º.  
- `final_score` ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–π –±–∞–ª–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:  
  `0.2 * validity + 0.4 * optimization + 0.2 * security`).  

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
```bash
python query_benchmark.py
```
–∏–ª–∏ –∏–∑ –∫–æ–¥–∞:
```python
from query_benchmark import evaluate_query

query = "SELECT id, name FROM users WHERE age > 18"
result = evaluate_query(query)
print(result)
```

### 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
```python
from query_benchmark import evaluate_pair

input_q = "SELECT * FROM users"
output_q = "SELECT id, name FROM users"
res = evaluate_pair(input_q, output_q)
print(res["delta"])  # —É–ª—É—á—à–µ–Ω–∏—è –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º
```

### 3. –ú–∞—Å—Å–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –∏–∑ JSONL
–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞:
```json
{"input": "SELECT * FROM users", "output": "SELECT id FROM users"}
```

–ó–∞–ø—É—Å–∫:
```python
from query_benchmark import evaluate_jsonl

report = evaluate_jsonl("data/queries.jsonl")
print(report)
```
